haplo
====
haplo lets you write both your front-end and back-end in the same codebase.

```javascript
// main.js
haplo.server(function() {
    var data = 'foobar';
    haplo.client(function(data) {
        alert(data);
    })(data);
});
```

The data variable will only exist on the server and be retrieved by the client via AJAX on load. It works by compiling it down to separate files, one for each end, and automatically setting up routes for the transition between contexts.

```sh
$ haplo main.js
```

```javascript
// client.js
haplo.server(1)(function (data) {
    alert(data);
});
```

```javascript
// server.js
haplo.on(1, function () {
    var data = 'foobar';
    return haplo.client(data);
});
```

# Installation
#### 1. Install haplo globally:

```sh
$ npm install --global haplo
```

#### 2. Install haplo in your project

```sh
$ npm install haplo
```

#### 3. Create main.js in the project's root

```javascript
// app/main.js
var haplo = request('haplo');

console.log('Sending request to server');
haplo.server(function() {
    console.log('Request catched by server, responding to browser');
    haplo.client(function() {
        console.log('Response catched by client, roundtrip done');
    });
});
```

#### 4. Create a public folder with an index.html

```html
<!-- app/public/index.html -->
<script src="dist/bundle.js"></script> <!-- bundle.js will be generated by the haplo command -->
```

#### 5. Run haplo:

```sh
$ haplo
```

#### 6. Done!

Your application is now live at [http://localhost:3000](http://localhost:3000).

Fire it up and have a look at the browser's console as well the terminal window where haplo is running. You should see that the console messages are printed in their respective environments.
